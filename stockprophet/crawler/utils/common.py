import time

from requests import Request, Session
import urllib3


urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
DEFAULT_TIMEOUT = 10
SUPPORTED_METHOD = ['GET', 'POST']


class DummyResponse(object):
    def __init__(self, content='', json=None, status_code=404):
        if json is None:
            json = dict()
        self.json = json
        self.content = content
        self.status_code = status_code


class HttpRequest(object):
    def __init__(self, wait_interval=None):
        self._wait_interval = wait_interval

    @staticmethod
    def default_headers():
        return {'Accept': 'application/json',
                'User-Agent': "Mozilla/5.0 (Windows NT 6.3; WOW64; rv:34.0)"}

    @staticmethod
    def form_headers():
        return {'Content-type': 'application/x-www-form-urlencoded',
                'User-Agent': "Mozilla/5.0 (Windows NT 6.3; WOW64; rv:34.0)"}

    @property
    def wait_interval(self):
        return self._wait_interval

    @wait_interval.setter
    def wait_interval(self, new_interval):
        self._wait_interval = new_interval

    def send_data(self, method, url, verify=False, **kwargs):
        if self._wait_interval:
            time.sleep(self.wait_interval)

        if method.upper() not in SUPPORTED_METHOD:
            return None

        with Session() as s:
            try:
                req = Request(method, url=url, **kwargs)
                prepared = req.prepare()
                resp = s.send(prepared, verify=verify, timeout=DEFAULT_TIMEOUT)
            except Exception as e:
                resp = DummyResponse()
                resp.content = str(e)
            finally:
                return resp


def get_stock_dates():
    data = {
        "update_date": "2021-12-01",
        "market_holiday": [
            "2022-01-01", "2022-01-27", "2022-01-28", "2022-01-31", "2022-02-01",
            "2022-02-02", "2022-02-03", "2022-02-04", "2022-02-28", "2022-04-04",
            "2022-04-05", "2022-05-01", "2022-05-02", "2022-06-03", "2022-09-09",
            "2022-10-10",
            "2021-01-01", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11",
            "2021-02-12", "2021-02-15", "2021-02-16", "2021-03-01", "2021-04-02",
            "2021-04-05", "2021-04-30", "2021-06-14", "2021-09-20", "2021-09-21",
            "2021-10-11", "2021-12-31",
            "2020-01-01", "2020-01-21", "2020-01-22", "2020-01-23", "2020-01-24",
            "2020-01-27", "2020-01-28", "2020-01-29", "2020-02-28", "2020-04-02",
            "2020-04-03", "2020-05-01", "2020-06-25", "2020-06-26", "2020-10-01",
            "2020-10-02", "2020-10-09",
            "2019-01-01", "2019-01-30", "2019-01-31", "2019-02-01", "2019-02-04",
            "2019-02-05", "2019-02-06", "2019-02-07", "2019-02-08", "2019-02-28",
            "2019-03-01", "2019-04-04", "2019-04-05", "2019-05-01", "2019-06-07",
            "2019-08-09", "2019-09-13", "2019-09-30", "2019-10-10", "2019-10-11",
            "2018-01-01", "2018-02-13", "2018-02-14", "2018-02-15", "2018-02-16",
            "2018-02-17", "2018-02-18", "2018-02-19", "2018-02-20", "2018-02-28",
            "2018-04-04", "2018-04-05", "2018-04-06", "2018-05-01", "2018-06-18",
            "2018-09-24", "2018-10-10", "2018-12-31",
            "2017-01-01", "2017-01-02", "2017-01-25", "2017-01-26", "2017-01-27",
            "2017-01-28", "2017-01-29", "2017-01-30", "2017-01-31", "2017-02-01",
            "2017-02-27", "2017-02-28", "2017-04-03", "2017-04-04", "2017-05-01",
            "2017-05-29", "2017-05-30", "2017-10-04", "2017-10-09", "2017-10-10",
            "2016-01-01", "2016-02-04", "2016-02-05", "2016-02-07", "2016-02-08",
            "2016-02-09", "2016-02-10", "2016-02-11", "2016-02-12", "2016-02-28",
            "2016-02-29", "2016-04-04", "2016-04-05", "2016-05-01", "2016-05-02",
            "2016-06-09", "2016-06-10", "2016-07-08", "2016-09-15", "2016-09-16",
            "2016-09-27", "2016-09-28", "2016-10-10",
            "2015-01-01", "2015-01-02", "2015-02-16", "2015-02-17", "2015-02-18",
            "2015-02-19", "2015-02-20", "2015-02-21", "2015-02-22", "2015-02-23",
            "2015-02-27", "2015-02-28", "2015-04-03", "2015-04-04", "2015-04-05",
            "2015-04-06", "2015-05-01", "2015-06-19", "2015-06-20", "2015-07-10",
            "2015-09-27", "2015-09-28", "2015-09-29", "2015-10-09", "2015-10-10",
            "2014-01-01", "2014-01-28", "2014-01-29", "2014-01-30", "2014-01-31",
            "2014-02-01", "2014-02-02", "2014-02-03", "2014-02-04", "2014-02-28",
            "2014-04-04", "2014-04-05", "2014-05-01", "2014-06-02", "2014-07-23",
            "2014-09-08", "2014-10-10",
            "2013-01-01", "2013-02-07", "2013-02-08", "2013-02-09", "2013-02-10",
            "2013-02-11", "2013-02-12", "2013-02-13", "2013-02-14", "2013-02-15",
            "2013-02-28", "2013-04-04", "2013-04-05", "2013-05-01", "2013-06-12",
            "2013-08-21", "2013-09-19", "2013-09-20", "2013-10-10",
            "2012-01-01", "2012-01-19", "2012-01-20", "2012-01-22", "2012-01-23",
            "2012-01-24", "2012-01-25", "2012-01-26", "2012-01-27", "2012-02-27",
            "2012-02-28", "2012-04-04", "2012-05-01", "2012-06-23", "2012-08-02",
            "2012-09-30", "2012-10-10", "2012-12-31",
            "2011-01-01", "2011-01-31", "2011-02-01", "2011-02-02", "2011-02-03",
            "2011-02-04", "2011-02-05", "2011-02-06", "2011-02-07", "2011-02-28",
            "2011-04-04", "2011-04-05", "2011-05-01", "2011-05-02", "2011-06-06",
            "2011-09-12", "2011-10-10",
            "2010-01-01", "2010-02-11", "2010-02-12", "2010-02-13", "2010-02-14",
            "2010-02-15", "2010-02-16", "2010-02-17", "2010-02-18", "2010-02-19",
            "2010-02-20", "2010-02-21", "2010-02-28", "2010-04-05", "2010-05-01",
            "2010-06-16", "2010-09-22", "2010-10-10",
            "2009-01-01", "2009-01-02", "2009-01-22", "2009-01-23", "2009-01-24",
            "2009-01-25", "2009-01-26", "2009-01-27", "2009-01-28", "2009-01-29",
            "2009-01-30", "2009-01-31", "2009-02-01", "2009-02-28", "2009-04-04",
            "2009-05-01", "2009-05-28", "2009-05-29", "2009-08-07", "2009-10-03",
            "2009-10-10",
            "2008-01-01", "2008-02-04", "2008-02-05", "2008-02-06", "2008-02-07",
            "2008-02-08", "2008-02-09", "2008-02-10", "2008-02-11", "2008-02-28",
            "2008-04-04", "2008-05-01", "2008-07-28", "2008-09-29", "2008-10-10",
            "2007-01-01", "2007-02-15", "2007-02-16", "2007-02-17", "2007-02-18",
            "2007-02-19", "2007-02-20", "2007-02-21", "2007-02-22", "2007-02-23",
            "2007-02-24", "2007-02-25", "2007-02-28", "2007-04-05", "2007-04-06",
            "2007-05-01", "2007-06-18", "2007-06-19", "2007-09-18", "2007-09-24",
            "2007-09-25", "2007-10-10",
            "2006-01-01", "2006-01-26", "2006-01-27", "2006-01-28", "2006-01-29",
            "2006-01-30", "2006-01-31", "2006-02-01", "2006-02-02", "2006-02-28",
            "2006-04-05", "2006-05-01", "2006-05-31", "2006-10-06", "2006-10-09",
            "2006-10-10",
            "2005-01-01", "2005-02-04", "2005-02-05", "2005-02-07", "2005-02-08",
            "2005-02-09", "2005-02-10", "2005-02-11", "2005-02-28", "2005-04-05",
            "2005-05-01", "2005-05-02", "2005-06-11", "2005-07-18", "2005-08-05",
            "2005-09-01", "2005-09-18", "2005-10-10",
            "2004-01-01", "2004-01-19", "2004-01-20", "2004-01-21", "2004-01-22",
            "2004-01-23", "2004-01-24", "2004-01-25", "2004-01-26", "2004-02-28",
            "2004-04-04", "2004-05-01", "2004-06-22", "2004-08-24", "2004-08-25",
            "2004-09-28", "2004-10-10", "2004-10-25",
            "2003-01-01", "2003-01-29", "2003-01-30", "2003-01-31", "2003-02-01",
            "2003-02-02", "2003-02-03", "2003-02-04", "2003-02-05", "2003-02-28",
            "2003-04-05", "2003-05-01", "2003-06-04", "2003-06-21", "2003-09-11",
            "2003-10-10",
            "2002-01-01", "2002-02-07", "2002-02-08", "2002-02-11", "2002-02-12",
            "2002-02-13", "2002-02-14", "2002-02-15", "2002-02-28", "2002-04-05",
            "2002-05-01", "2002-06-01", "2002-06-15", "2002-06-22", "2002-10-10"],
        "additional_trading_day": [
            "2018-03-31", "2018-12-22", "2017-02-18", "2017-06-30", "2017-09-30",
            "2016-01-30", "2016-06-04", "2016-09-10", "2014-12-27", "2013-02-23",
            "2013-09-14", "2012-02-04", "2012-03-03", "2012-12-22", "2010-02-06",
            "2009-01-10", "2009-01-17", "2009-06-06", "2007-03-03", "2007-04-14",
            "2007-09-29", "2006-10-14"
        ]
    }
    return data


def convert_to_float(string):
    # noinspection PyBroadException
    try:
        data = ''.join(string.split(','))
        return float(data)
    except Exception:
        return None


def convert_to_int(string):
    # noinspection PyBroadException
    try:
        data = ''.join(string.split(','))
        return int(data)
    except Exception:
        return None


def convert_to_direction(direction):
    if direction == ' ':
        return 0
    else:
        if '-' in direction:
            return -1
        return 1


def convert_change_to_string(sign_change):
    # noinspection PyBroadException
    try:
        num = float(sign_change)
        if num > 0:
            return '+', str(num)
        elif num < 0:
            return '-', str(num)
        else:
            return ' ', '0.0'
    except Exception:
        return ' ', '0.0'
